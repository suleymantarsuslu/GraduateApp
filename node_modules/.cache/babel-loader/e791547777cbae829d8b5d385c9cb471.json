{"ast":null,"code":"\"use strict\";\n\nvar FormatValidators = require(\"./FormatValidators\"),\n    JsonValidation = require(\"./JsonValidation\"),\n    Report = require(\"./Report\"),\n    Utils = require(\"./Utils\");\n\nvar SchemaValidators = {\n  $ref: function (report, schema) {\n    // http://tools.ietf.org/html/draft-ietf-appsawg-json-pointer-07\n    // http://tools.ietf.org/html/draft-pbryan-zyp-json-ref-03\n    if (typeof schema.$ref !== \"string\") {\n      report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"$ref\", \"string\"]);\n    }\n  },\n  $schema: function (report, schema) {\n    // http://json-schema.org/latest/json-schema-core.html#rfc.section.6\n    if (typeof schema.$schema !== \"string\") {\n      report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"$schema\", \"string\"]);\n    }\n  },\n  multipleOf: function (report, schema) {\n    // http://json-schema.org/latest/json-schema-validation.html#rfc.section.5.1.1.1\n    if (typeof schema.multipleOf !== \"number\") {\n      report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"multipleOf\", \"number\"]);\n    } else if (schema.multipleOf <= 0) {\n      report.addError(\"KEYWORD_MUST_BE\", [\"multipleOf\", \"strictly greater than 0\"]);\n    }\n  },\n  maximum: function (report, schema) {\n    // http://json-schema.org/latest/json-schema-validation.html#rfc.section.5.1.2.1\n    if (typeof schema.maximum !== \"number\") {\n      report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"maximum\", \"number\"]);\n    }\n  },\n  exclusiveMaximum: function (report, schema) {\n    // http://json-schema.org/latest/json-schema-validation.html#rfc.section.5.1.2.1\n    if (typeof schema.exclusiveMaximum !== \"boolean\") {\n      report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"exclusiveMaximum\", \"boolean\"]);\n    } else if (schema.maximum === undefined) {\n      report.addError(\"KEYWORD_DEPENDENCY\", [\"exclusiveMaximum\", \"maximum\"]);\n    }\n  },\n  minimum: function (report, schema) {\n    // http://json-schema.org/latest/json-schema-validation.html#rfc.section.5.1.3.1\n    if (typeof schema.minimum !== \"number\") {\n      report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"minimum\", \"number\"]);\n    }\n  },\n  exclusiveMinimum: function (report, schema) {\n    // http://json-schema.org/latest/json-schema-validation.html#rfc.section.5.1.3.1\n    if (typeof schema.exclusiveMinimum !== \"boolean\") {\n      report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"exclusiveMinimum\", \"boolean\"]);\n    } else if (schema.minimum === undefined) {\n      report.addError(\"KEYWORD_DEPENDENCY\", [\"exclusiveMinimum\", \"minimum\"]);\n    }\n  },\n  maxLength: function (report, schema) {\n    // http://json-schema.org/latest/json-schema-validation.html#rfc.section.5.2.1.1\n    if (Utils.whatIs(schema.maxLength) !== \"integer\") {\n      report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"maxLength\", \"integer\"]);\n    } else if (schema.maxLength < 0) {\n      report.addError(\"KEYWORD_MUST_BE\", [\"maxLength\", \"greater than, or equal to 0\"]);\n    }\n  },\n  minLength: function (report, schema) {\n    // http://json-schema.org/latest/json-schema-validation.html#rfc.section.5.2.2.1\n    if (Utils.whatIs(schema.minLength) !== \"integer\") {\n      report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"minLength\", \"integer\"]);\n    } else if (schema.minLength < 0) {\n      report.addError(\"KEYWORD_MUST_BE\", [\"minLength\", \"greater than, or equal to 0\"]);\n    }\n  },\n  pattern: function (report, schema) {\n    // http://json-schema.org/latest/json-schema-validation.html#rfc.section.5.2.3.1\n    if (typeof schema.pattern !== \"string\") {\n      report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"pattern\", \"string\"]);\n    } else {\n      try {\n        RegExp(schema.pattern);\n      } catch (e) {\n        report.addError(\"KEYWORD_PATTERN\", [\"pattern\", schema.pattern]);\n      }\n    }\n  },\n  additionalItems: function (report, schema) {\n    // http://json-schema.org/latest/json-schema-validation.html#rfc.section.5.3.1.1\n    var type = Utils.whatIs(schema.additionalItems);\n\n    if (type !== \"boolean\" && type !== \"object\") {\n      report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"additionalItems\", [\"boolean\", \"object\"]]);\n    } else if (type === \"object\") {\n      report.path.push(\"additionalItems\");\n      exports.validateSchema.call(this, report, schema.additionalItems);\n      report.path.pop();\n    }\n  },\n  items: function (report, schema) {\n    // http://json-schema.org/latest/json-schema-validation.html#rfc.section.5.3.1.1\n    var type = Utils.whatIs(schema.items);\n\n    if (type === \"object\") {\n      report.path.push(\"items\");\n      exports.validateSchema.call(this, report, schema.items);\n      report.path.pop();\n    } else if (type === \"array\") {\n      var idx = schema.items.length;\n\n      while (idx--) {\n        report.path.push(\"items\");\n        report.path.push(idx.toString());\n        exports.validateSchema.call(this, report, schema.items[idx]);\n        report.path.pop();\n        report.path.pop();\n      }\n    } else {\n      report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"items\", [\"array\", \"object\"]]);\n    } // custom - strict mode\n\n\n    if (this.options.forceAdditional === true && schema.additionalItems === undefined && Array.isArray(schema.items)) {\n      report.addError(\"KEYWORD_UNDEFINED_STRICT\", [\"additionalItems\"]);\n    } // custome - assume defined false mode\n\n\n    if (this.options.assumeAdditional && schema.additionalItems === undefined && Array.isArray(schema.items)) {\n      schema.additionalItems = false;\n    }\n  },\n  maxItems: function (report, schema) {\n    // http://json-schema.org/latest/json-schema-validation.html#rfc.section.5.3.2.1\n    if (typeof schema.maxItems !== \"number\") {\n      report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"maxItems\", \"integer\"]);\n    } else if (schema.maxItems < 0) {\n      report.addError(\"KEYWORD_MUST_BE\", [\"maxItems\", \"greater than, or equal to 0\"]);\n    }\n  },\n  minItems: function (report, schema) {\n    // http://json-schema.org/latest/json-schema-validation.html#rfc.section.5.3.3.1\n    if (Utils.whatIs(schema.minItems) !== \"integer\") {\n      report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"minItems\", \"integer\"]);\n    } else if (schema.minItems < 0) {\n      report.addError(\"KEYWORD_MUST_BE\", [\"minItems\", \"greater than, or equal to 0\"]);\n    }\n  },\n  uniqueItems: function (report, schema) {\n    // http://json-schema.org/latest/json-schema-validation.html#rfc.section.5.3.4.1\n    if (typeof schema.uniqueItems !== \"boolean\") {\n      report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"uniqueItems\", \"boolean\"]);\n    }\n  },\n  maxProperties: function (report, schema) {\n    // http://json-schema.org/latest/json-schema-validation.html#rfc.section.5.4.1.1\n    if (Utils.whatIs(schema.maxProperties) !== \"integer\") {\n      report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"maxProperties\", \"integer\"]);\n    } else if (schema.maxProperties < 0) {\n      report.addError(\"KEYWORD_MUST_BE\", [\"maxProperties\", \"greater than, or equal to 0\"]);\n    }\n  },\n  minProperties: function (report, schema) {\n    // http://json-schema.org/latest/json-schema-validation.html#rfc.section.5.4.2.1\n    if (Utils.whatIs(schema.minProperties) !== \"integer\") {\n      report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"minProperties\", \"integer\"]);\n    } else if (schema.minProperties < 0) {\n      report.addError(\"KEYWORD_MUST_BE\", [\"minProperties\", \"greater than, or equal to 0\"]);\n    }\n  },\n  required: function (report, schema) {\n    // http://json-schema.org/latest/json-schema-validation.html#rfc.section.5.4.3.1\n    if (Utils.whatIs(schema.required) !== \"array\") {\n      report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"required\", \"array\"]);\n    } else if (schema.required.length === 0) {\n      report.addError(\"KEYWORD_MUST_BE\", [\"required\", \"an array with at least one element\"]);\n    } else {\n      var idx = schema.required.length;\n\n      while (idx--) {\n        if (typeof schema.required[idx] !== \"string\") {\n          report.addError(\"KEYWORD_VALUE_TYPE\", [\"required\", \"string\"]);\n        }\n      }\n\n      if (Utils.isUniqueArray(schema.required) === false) {\n        report.addError(\"KEYWORD_MUST_BE\", [\"required\", \"an array with unique items\"]);\n      }\n    }\n  },\n  additionalProperties: function (report, schema) {\n    // http://json-schema.org/latest/json-schema-validation.html#rfc.section.5.4.4.1\n    var type = Utils.whatIs(schema.additionalProperties);\n\n    if (type !== \"boolean\" && type !== \"object\") {\n      report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"additionalProperties\", [\"boolean\", \"object\"]]);\n    } else if (type === \"object\") {\n      report.path.push(\"additionalProperties\");\n      exports.validateSchema.call(this, report, schema.additionalProperties);\n      report.path.pop();\n    }\n  },\n  properties: function (report, schema) {\n    // http://json-schema.org/latest/json-schema-validation.html#rfc.section.5.4.4.1\n    if (Utils.whatIs(schema.properties) !== \"object\") {\n      report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"properties\", \"object\"]);\n      return;\n    }\n\n    var keys = Object.keys(schema.properties),\n        idx = keys.length;\n\n    while (idx--) {\n      var key = keys[idx],\n          val = schema.properties[key];\n      report.path.push(\"properties\");\n      report.path.push(key);\n      exports.validateSchema.call(this, report, val);\n      report.path.pop();\n      report.path.pop();\n    } // custom - strict mode\n\n\n    if (this.options.forceAdditional === true && schema.additionalProperties === undefined) {\n      report.addError(\"KEYWORD_UNDEFINED_STRICT\", [\"additionalProperties\"]);\n    } // custome - assume defined false mode\n\n\n    if (this.options.assumeAdditional && schema.additionalProperties === undefined) {\n      schema.additionalProperties = false;\n    } // custom - forceProperties\n\n\n    if (this.options.forceProperties === true && keys.length === 0) {\n      report.addError(\"CUSTOM_MODE_FORCE_PROPERTIES\", [\"properties\"]);\n    }\n  },\n  patternProperties: function (report, schema) {\n    // http://json-schema.org/latest/json-schema-validation.html#rfc.section.5.4.4.1\n    if (Utils.whatIs(schema.patternProperties) !== \"object\") {\n      report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"patternProperties\", \"object\"]);\n      return;\n    }\n\n    var keys = Object.keys(schema.patternProperties),\n        idx = keys.length;\n\n    while (idx--) {\n      var key = keys[idx],\n          val = schema.patternProperties[key];\n\n      try {\n        RegExp(key);\n      } catch (e) {\n        report.addError(\"KEYWORD_PATTERN\", [\"patternProperties\", key]);\n      }\n\n      report.path.push(\"patternProperties\");\n      report.path.push(key.toString());\n      exports.validateSchema.call(this, report, val);\n      report.path.pop();\n      report.path.pop();\n    } // custom - forceProperties\n\n\n    if (this.options.forceProperties === true && keys.length === 0) {\n      report.addError(\"CUSTOM_MODE_FORCE_PROPERTIES\", [\"patternProperties\"]);\n    }\n  },\n  dependencies: function (report, schema) {\n    // http://json-schema.org/latest/json-schema-validation.html#rfc.section.5.4.5.1\n    if (Utils.whatIs(schema.dependencies) !== \"object\") {\n      report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"dependencies\", \"object\"]);\n    } else {\n      var keys = Object.keys(schema.dependencies),\n          idx = keys.length;\n\n      while (idx--) {\n        var schemaKey = keys[idx],\n            schemaDependency = schema.dependencies[schemaKey],\n            type = Utils.whatIs(schemaDependency);\n\n        if (type === \"object\") {\n          report.path.push(\"dependencies\");\n          report.path.push(schemaKey);\n          exports.validateSchema.call(this, report, schemaDependency);\n          report.path.pop();\n          report.path.pop();\n        } else if (type === \"array\") {\n          var idx2 = schemaDependency.length;\n\n          if (idx2 === 0) {\n            report.addError(\"KEYWORD_MUST_BE\", [\"dependencies\", \"not empty array\"]);\n          }\n\n          while (idx2--) {\n            if (typeof schemaDependency[idx2] !== \"string\") {\n              report.addError(\"KEYWORD_VALUE_TYPE\", [\"dependensices\", \"string\"]);\n            }\n          }\n\n          if (Utils.isUniqueArray(schemaDependency) === false) {\n            report.addError(\"KEYWORD_MUST_BE\", [\"dependencies\", \"an array with unique items\"]);\n          }\n        } else {\n          report.addError(\"KEYWORD_VALUE_TYPE\", [\"dependencies\", \"object or array\"]);\n        }\n      }\n    }\n  },\n  enum: function (report, schema) {\n    // http://json-schema.org/latest/json-schema-validation.html#rfc.section.5.5.1.1\n    if (Array.isArray(schema.enum) === false) {\n      report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"enum\", \"array\"]);\n    } else if (schema.enum.length === 0) {\n      report.addError(\"KEYWORD_MUST_BE\", [\"enum\", \"an array with at least one element\"]);\n    } else if (Utils.isUniqueArray(schema.enum) === false) {\n      report.addError(\"KEYWORD_MUST_BE\", [\"enum\", \"an array with unique elements\"]);\n    }\n  },\n  type: function (report, schema) {\n    // http://json-schema.org/latest/json-schema-validation.html#rfc.section.5.5.2.1\n    var primitiveTypes = [\"array\", \"boolean\", \"integer\", \"number\", \"null\", \"object\", \"string\"],\n        primitiveTypeStr = primitiveTypes.join(\",\"),\n        isArray = Array.isArray(schema.type);\n\n    if (isArray) {\n      var idx = schema.type.length;\n\n      while (idx--) {\n        if (primitiveTypes.indexOf(schema.type[idx]) === -1) {\n          report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"type\", primitiveTypeStr]);\n        }\n      }\n\n      if (Utils.isUniqueArray(schema.type) === false) {\n        report.addError(\"KEYWORD_MUST_BE\", [\"type\", \"an object with unique properties\"]);\n      }\n    } else if (typeof schema.type === \"string\") {\n      if (primitiveTypes.indexOf(schema.type) === -1) {\n        report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"type\", primitiveTypeStr]);\n      }\n    } else {\n      report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"type\", [\"string\", \"array\"]]);\n    }\n\n    if (this.options.noEmptyStrings === true) {\n      if (schema.type === \"string\" || isArray && schema.type.indexOf(\"string\") !== -1) {\n        if (schema.minLength === undefined && schema.enum === undefined && schema.format === undefined) {\n          schema.minLength = 1;\n        }\n      }\n    }\n\n    if (this.options.noEmptyArrays === true) {\n      if (schema.type === \"array\" || isArray && schema.type.indexOf(\"array\") !== -1) {\n        if (schema.minItems === undefined) {\n          schema.minItems = 1;\n        }\n      }\n    }\n\n    if (this.options.forceProperties === true) {\n      if (schema.type === \"object\" || isArray && schema.type.indexOf(\"object\") !== -1) {\n        if (schema.properties === undefined && schema.patternProperties === undefined) {\n          report.addError(\"KEYWORD_UNDEFINED_STRICT\", [\"properties\"]);\n        }\n      }\n    }\n\n    if (this.options.forceItems === true) {\n      if (schema.type === \"array\" || isArray && schema.type.indexOf(\"array\") !== -1) {\n        if (schema.items === undefined) {\n          report.addError(\"KEYWORD_UNDEFINED_STRICT\", [\"items\"]);\n        }\n      }\n    }\n\n    if (this.options.forceMinItems === true) {\n      if (schema.type === \"array\" || isArray && schema.type.indexOf(\"array\") !== -1) {\n        if (schema.minItems === undefined) {\n          report.addError(\"KEYWORD_UNDEFINED_STRICT\", [\"minItems\"]);\n        }\n      }\n    }\n\n    if (this.options.forceMaxItems === true) {\n      if (schema.type === \"array\" || isArray && schema.type.indexOf(\"array\") !== -1) {\n        if (schema.maxItems === undefined) {\n          report.addError(\"KEYWORD_UNDEFINED_STRICT\", [\"maxItems\"]);\n        }\n      }\n    }\n\n    if (this.options.forceMinLength === true) {\n      if (schema.type === \"string\" || isArray && schema.type.indexOf(\"string\") !== -1) {\n        if (schema.minLength === undefined && schema.format === undefined && schema.enum === undefined && schema.pattern === undefined) {\n          report.addError(\"KEYWORD_UNDEFINED_STRICT\", [\"minLength\"]);\n        }\n      }\n    }\n\n    if (this.options.forceMaxLength === true) {\n      if (schema.type === \"string\" || isArray && schema.type.indexOf(\"string\") !== -1) {\n        if (schema.maxLength === undefined && schema.format === undefined && schema.enum === undefined && schema.pattern === undefined) {\n          report.addError(\"KEYWORD_UNDEFINED_STRICT\", [\"maxLength\"]);\n        }\n      }\n    }\n  },\n  allOf: function (report, schema) {\n    // http://json-schema.org/latest/json-schema-validation.html#rfc.section.5.5.3.1\n    if (Array.isArray(schema.allOf) === false) {\n      report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"allOf\", \"array\"]);\n    } else if (schema.allOf.length === 0) {\n      report.addError(\"KEYWORD_MUST_BE\", [\"allOf\", \"an array with at least one element\"]);\n    } else {\n      var idx = schema.allOf.length;\n\n      while (idx--) {\n        report.path.push(\"allOf\");\n        report.path.push(idx.toString());\n        exports.validateSchema.call(this, report, schema.allOf[idx]);\n        report.path.pop();\n        report.path.pop();\n      }\n    }\n  },\n  anyOf: function (report, schema) {\n    // http://json-schema.org/latest/json-schema-validation.html#rfc.section.5.5.4.1\n    if (Array.isArray(schema.anyOf) === false) {\n      report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"anyOf\", \"array\"]);\n    } else if (schema.anyOf.length === 0) {\n      report.addError(\"KEYWORD_MUST_BE\", [\"anyOf\", \"an array with at least one element\"]);\n    } else {\n      var idx = schema.anyOf.length;\n\n      while (idx--) {\n        report.path.push(\"anyOf\");\n        report.path.push(idx.toString());\n        exports.validateSchema.call(this, report, schema.anyOf[idx]);\n        report.path.pop();\n        report.path.pop();\n      }\n    }\n  },\n  oneOf: function (report, schema) {\n    // http://json-schema.org/latest/json-schema-validation.html#rfc.section.5.5.5.1\n    if (Array.isArray(schema.oneOf) === false) {\n      report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"oneOf\", \"array\"]);\n    } else if (schema.oneOf.length === 0) {\n      report.addError(\"KEYWORD_MUST_BE\", [\"oneOf\", \"an array with at least one element\"]);\n    } else {\n      var idx = schema.oneOf.length;\n\n      while (idx--) {\n        report.path.push(\"oneOf\");\n        report.path.push(idx.toString());\n        exports.validateSchema.call(this, report, schema.oneOf[idx]);\n        report.path.pop();\n        report.path.pop();\n      }\n    }\n  },\n  not: function (report, schema) {\n    // http://json-schema.org/latest/json-schema-validation.html#rfc.section.5.5.6.1\n    if (Utils.whatIs(schema.not) !== \"object\") {\n      report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"not\", \"object\"]);\n    } else {\n      report.path.push(\"not\");\n      exports.validateSchema.call(this, report, schema.not);\n      report.path.pop();\n    }\n  },\n  definitions: function (report, schema) {\n    // http://json-schema.org/latest/json-schema-validation.html#rfc.section.5.5.7.1\n    if (Utils.whatIs(schema.definitions) !== \"object\") {\n      report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"definitions\", \"object\"]);\n    } else {\n      var keys = Object.keys(schema.definitions),\n          idx = keys.length;\n\n      while (idx--) {\n        var key = keys[idx],\n            val = schema.definitions[key];\n        report.path.push(\"definitions\");\n        report.path.push(key);\n        exports.validateSchema.call(this, report, val);\n        report.path.pop();\n        report.path.pop();\n      }\n    }\n  },\n  format: function (report, schema) {\n    if (typeof schema.format !== \"string\") {\n      report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"format\", \"string\"]);\n    } else {\n      if (FormatValidators[schema.format] === undefined && this.options.ignoreUnknownFormats !== true) {\n        report.addError(\"UNKNOWN_FORMAT\", [schema.format]);\n      }\n    }\n  },\n  id: function (report, schema) {\n    // http://json-schema.org/latest/json-schema-core.html#rfc.section.7.2\n    if (typeof schema.id !== \"string\") {\n      report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"id\", \"string\"]);\n    }\n  },\n  title: function (report, schema) {\n    // http://json-schema.org/latest/json-schema-validation.html#rfc.section.6.1\n    if (typeof schema.title !== \"string\") {\n      report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"title\", \"string\"]);\n    }\n  },\n  description: function (report, schema) {\n    // http://json-schema.org/latest/json-schema-validation.html#rfc.section.6.1\n    if (typeof schema.description !== \"string\") {\n      report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"description\", \"string\"]);\n    }\n  },\n  \"default\": function ()\n  /* report, schema */\n  {// http://json-schema.org/latest/json-schema-validation.html#rfc.section.6.2\n    // There are no restrictions placed on the value of this keyword.\n  }\n};\n/**\n *\n * @param {Report} report\n * @param {*[]} arr\n *\n * @returns {boolean}\n */\n\nvar validateArrayOfSchemas = function (report, arr) {\n  var idx = arr.length;\n\n  while (idx--) {\n    exports.validateSchema.call(this, report, arr[idx]);\n  }\n\n  return report.isValid();\n};\n/**\n *\n * @param {Report} report\n * @param {*} schema\n */\n\n\nexports.validateSchema = function (report, schema) {\n  report.commonErrorMessage = \"SCHEMA_VALIDATION_FAILED\"; // if schema is an array, assume it's an array of schemas\n\n  if (Array.isArray(schema)) {\n    return validateArrayOfSchemas.call(this, report, schema);\n  } // do not revalidate schema that has already been validated once\n\n\n  if (schema.__$validated) {\n    return true;\n  } // if $schema is present, this schema should validate against that $schema\n\n\n  var hasParentSchema = schema.$schema && schema.id !== schema.$schema;\n\n  if (hasParentSchema) {\n    if (schema.__$schemaResolved && schema.__$schemaResolved !== schema) {\n      var subReport = new Report(report);\n      var valid = JsonValidation.validate.call(this, subReport, schema.__$schemaResolved, schema);\n\n      if (valid === false) {\n        report.addError(\"PARENT_SCHEMA_VALIDATION_FAILED\", null, subReport);\n      }\n    } else {\n      if (this.options.ignoreUnresolvableReferences !== true) {\n        report.addError(\"REF_UNRESOLVED\", [schema.$schema]);\n      }\n    }\n  }\n\n  if (this.options.noTypeless === true) {\n    // issue #36 - inherit type to anyOf, oneOf, allOf if noTypeless is defined\n    if (schema.type !== undefined) {\n      var schemas = [];\n\n      if (Array.isArray(schema.anyOf)) {\n        schemas = schemas.concat(schema.anyOf);\n      }\n\n      if (Array.isArray(schema.oneOf)) {\n        schemas = schemas.concat(schema.oneOf);\n      }\n\n      if (Array.isArray(schema.allOf)) {\n        schemas = schemas.concat(schema.allOf);\n      }\n\n      schemas.forEach(function (sch) {\n        if (!sch.type) {\n          sch.type = schema.type;\n        }\n      });\n    } // end issue #36\n\n\n    if (schema.enum === undefined && schema.type === undefined && schema.anyOf === undefined && schema.oneOf === undefined && schema.not === undefined && schema.$ref === undefined) {\n      report.addError(\"KEYWORD_UNDEFINED_STRICT\", [\"type\"]);\n    }\n  }\n\n  var keys = Object.keys(schema),\n      idx = keys.length;\n\n  while (idx--) {\n    var key = keys[idx];\n\n    if (key.indexOf(\"__\") === 0) {\n      continue;\n    }\n\n    if (SchemaValidators[key] !== undefined) {\n      SchemaValidators[key].call(this, report, schema);\n    } else if (!hasParentSchema) {\n      if (this.options.noExtraKeywords === true) {\n        report.addError(\"KEYWORD_UNEXPECTED\", [key]);\n      }\n    }\n  }\n\n  if (this.options.pedanticCheck === true) {\n    if (schema.enum) {\n      // break recursion\n      var tmpSchema = Utils.clone(schema);\n      delete tmpSchema.enum;\n      delete tmpSchema.default;\n      report.path.push(\"enum\");\n      idx = schema.enum.length;\n\n      while (idx--) {\n        report.path.push(idx.toString());\n        JsonValidation.validate.call(this, report, tmpSchema, schema.enum[idx]);\n        report.path.pop();\n      }\n\n      report.path.pop();\n    }\n\n    if (schema.default) {\n      report.path.push(\"default\");\n      JsonValidation.validate.call(this, report, schema, schema.default);\n      report.path.pop();\n    }\n  }\n\n  var isValid = report.isValid();\n\n  if (isValid) {\n    schema.__$validated = true;\n  }\n\n  return isValid;\n};","map":{"version":3,"sources":["/Users/suleymantarsuslu/Desktop/graduateApp/new/graduate/node_modules/z-schema/src/SchemaValidation.js"],"names":["FormatValidators","require","JsonValidation","Report","Utils","SchemaValidators","$ref","report","schema","addError","$schema","multipleOf","maximum","exclusiveMaximum","undefined","minimum","exclusiveMinimum","maxLength","whatIs","minLength","pattern","RegExp","e","additionalItems","type","path","push","exports","validateSchema","call","pop","items","idx","length","toString","options","forceAdditional","Array","isArray","assumeAdditional","maxItems","minItems","uniqueItems","maxProperties","minProperties","required","isUniqueArray","additionalProperties","properties","keys","Object","key","val","forceProperties","patternProperties","dependencies","schemaKey","schemaDependency","idx2","enum","primitiveTypes","primitiveTypeStr","join","indexOf","noEmptyStrings","format","noEmptyArrays","forceItems","forceMinItems","forceMaxItems","forceMinLength","forceMaxLength","allOf","anyOf","oneOf","not","definitions","ignoreUnknownFormats","id","title","description","validateArrayOfSchemas","arr","isValid","commonErrorMessage","__$validated","hasParentSchema","__$schemaResolved","subReport","valid","validate","ignoreUnresolvableReferences","noTypeless","schemas","concat","forEach","sch","noExtraKeywords","pedanticCheck","tmpSchema","clone","default"],"mappings":"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","sourcesContent":["\"use strict\";\n\nvar FormatValidators = require(\"./FormatValidators\"),\n    JsonValidation   = require(\"./JsonValidation\"),\n    Report           = require(\"./Report\"),\n    Utils            = require(\"./Utils\");\n\nvar SchemaValidators = {\n    $ref: function (report, schema) {\n        // http://tools.ietf.org/html/draft-ietf-appsawg-json-pointer-07\n        // http://tools.ietf.org/html/draft-pbryan-zyp-json-ref-03\n        if (typeof schema.$ref !== \"string\") {\n            report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"$ref\", \"string\"]);\n        }\n    },\n    $schema: function (report, schema) {\n        // http://json-schema.org/latest/json-schema-core.html#rfc.section.6\n        if (typeof schema.$schema !== \"string\") {\n            report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"$schema\", \"string\"]);\n        }\n    },\n    multipleOf: function (report, schema) {\n        // http://json-schema.org/latest/json-schema-validation.html#rfc.section.5.1.1.1\n        if (typeof schema.multipleOf !== \"number\") {\n            report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"multipleOf\", \"number\"]);\n        } else if (schema.multipleOf <= 0) {\n            report.addError(\"KEYWORD_MUST_BE\", [\"multipleOf\", \"strictly greater than 0\"]);\n        }\n    },\n    maximum: function (report, schema) {\n        // http://json-schema.org/latest/json-schema-validation.html#rfc.section.5.1.2.1\n        if (typeof schema.maximum !== \"number\") {\n            report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"maximum\", \"number\"]);\n        }\n    },\n    exclusiveMaximum: function (report, schema) {\n        // http://json-schema.org/latest/json-schema-validation.html#rfc.section.5.1.2.1\n        if (typeof schema.exclusiveMaximum !== \"boolean\") {\n            report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"exclusiveMaximum\", \"boolean\"]);\n        } else if (schema.maximum === undefined) {\n            report.addError(\"KEYWORD_DEPENDENCY\", [\"exclusiveMaximum\", \"maximum\"]);\n        }\n    },\n    minimum: function (report, schema) {\n        // http://json-schema.org/latest/json-schema-validation.html#rfc.section.5.1.3.1\n        if (typeof schema.minimum !== \"number\") {\n            report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"minimum\", \"number\"]);\n        }\n    },\n    exclusiveMinimum: function (report, schema) {\n        // http://json-schema.org/latest/json-schema-validation.html#rfc.section.5.1.3.1\n        if (typeof schema.exclusiveMinimum !== \"boolean\") {\n            report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"exclusiveMinimum\", \"boolean\"]);\n        } else if (schema.minimum === undefined) {\n            report.addError(\"KEYWORD_DEPENDENCY\", [\"exclusiveMinimum\", \"minimum\"]);\n        }\n    },\n    maxLength: function (report, schema) {\n        // http://json-schema.org/latest/json-schema-validation.html#rfc.section.5.2.1.1\n        if (Utils.whatIs(schema.maxLength) !== \"integer\") {\n            report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"maxLength\", \"integer\"]);\n        } else if (schema.maxLength < 0) {\n            report.addError(\"KEYWORD_MUST_BE\", [\"maxLength\", \"greater than, or equal to 0\"]);\n        }\n    },\n    minLength: function (report, schema) {\n        // http://json-schema.org/latest/json-schema-validation.html#rfc.section.5.2.2.1\n        if (Utils.whatIs(schema.minLength) !== \"integer\") {\n            report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"minLength\", \"integer\"]);\n        } else if (schema.minLength < 0) {\n            report.addError(\"KEYWORD_MUST_BE\", [\"minLength\", \"greater than, or equal to 0\"]);\n        }\n    },\n    pattern: function (report, schema) {\n        // http://json-schema.org/latest/json-schema-validation.html#rfc.section.5.2.3.1\n        if (typeof schema.pattern !== \"string\") {\n            report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"pattern\", \"string\"]);\n        } else {\n            try {\n                RegExp(schema.pattern);\n            } catch (e) {\n                report.addError(\"KEYWORD_PATTERN\", [\"pattern\", schema.pattern]);\n            }\n        }\n    },\n    additionalItems: function (report, schema) {\n        // http://json-schema.org/latest/json-schema-validation.html#rfc.section.5.3.1.1\n        var type = Utils.whatIs(schema.additionalItems);\n        if (type !== \"boolean\" && type !== \"object\") {\n            report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"additionalItems\", [\"boolean\", \"object\"]]);\n        } else if (type === \"object\") {\n            report.path.push(\"additionalItems\");\n            exports.validateSchema.call(this, report, schema.additionalItems);\n            report.path.pop();\n        }\n    },\n    items: function (report, schema) {\n        // http://json-schema.org/latest/json-schema-validation.html#rfc.section.5.3.1.1\n        var type = Utils.whatIs(schema.items);\n\n        if (type === \"object\") {\n            report.path.push(\"items\");\n            exports.validateSchema.call(this, report, schema.items);\n            report.path.pop();\n        } else if (type === \"array\") {\n            var idx = schema.items.length;\n            while (idx--) {\n                report.path.push(\"items\");\n                report.path.push(idx.toString());\n                exports.validateSchema.call(this, report, schema.items[idx]);\n                report.path.pop();\n                report.path.pop();\n            }\n        } else {\n            report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"items\", [\"array\", \"object\"]]);\n        }\n\n        // custom - strict mode\n        if (this.options.forceAdditional === true && schema.additionalItems === undefined && Array.isArray(schema.items)) {\n            report.addError(\"KEYWORD_UNDEFINED_STRICT\", [\"additionalItems\"]);\n        }\n        // custome - assume defined false mode\n        if (this.options.assumeAdditional && schema.additionalItems === undefined && Array.isArray(schema.items)) {\n            schema.additionalItems = false;\n        }\n    },\n    maxItems: function (report, schema) {\n        // http://json-schema.org/latest/json-schema-validation.html#rfc.section.5.3.2.1\n        if (typeof schema.maxItems !== \"number\") {\n            report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"maxItems\", \"integer\"]);\n        } else if (schema.maxItems < 0) {\n            report.addError(\"KEYWORD_MUST_BE\", [\"maxItems\", \"greater than, or equal to 0\"]);\n        }\n    },\n    minItems: function (report, schema) {\n        // http://json-schema.org/latest/json-schema-validation.html#rfc.section.5.3.3.1\n        if (Utils.whatIs(schema.minItems) !== \"integer\") {\n            report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"minItems\", \"integer\"]);\n        } else if (schema.minItems < 0) {\n            report.addError(\"KEYWORD_MUST_BE\", [\"minItems\", \"greater than, or equal to 0\"]);\n        }\n    },\n    uniqueItems: function (report, schema) {\n        // http://json-schema.org/latest/json-schema-validation.html#rfc.section.5.3.4.1\n        if (typeof schema.uniqueItems !== \"boolean\") {\n            report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"uniqueItems\", \"boolean\"]);\n        }\n    },\n    maxProperties: function (report, schema) {\n        // http://json-schema.org/latest/json-schema-validation.html#rfc.section.5.4.1.1\n        if (Utils.whatIs(schema.maxProperties) !== \"integer\") {\n            report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"maxProperties\", \"integer\"]);\n        } else if (schema.maxProperties < 0) {\n            report.addError(\"KEYWORD_MUST_BE\", [\"maxProperties\", \"greater than, or equal to 0\"]);\n        }\n    },\n    minProperties: function (report, schema) {\n        // http://json-schema.org/latest/json-schema-validation.html#rfc.section.5.4.2.1\n        if (Utils.whatIs(schema.minProperties) !== \"integer\") {\n            report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"minProperties\", \"integer\"]);\n        } else if (schema.minProperties < 0) {\n            report.addError(\"KEYWORD_MUST_BE\", [\"minProperties\", \"greater than, or equal to 0\"]);\n        }\n    },\n    required: function (report, schema) {\n        // http://json-schema.org/latest/json-schema-validation.html#rfc.section.5.4.3.1\n        if (Utils.whatIs(schema.required) !== \"array\") {\n            report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"required\", \"array\"]);\n        } else if (schema.required.length === 0) {\n            report.addError(\"KEYWORD_MUST_BE\", [\"required\", \"an array with at least one element\"]);\n        } else {\n            var idx = schema.required.length;\n            while (idx--) {\n                if (typeof schema.required[idx] !== \"string\") {\n                    report.addError(\"KEYWORD_VALUE_TYPE\", [\"required\", \"string\"]);\n                }\n            }\n            if (Utils.isUniqueArray(schema.required) === false) {\n                report.addError(\"KEYWORD_MUST_BE\", [\"required\", \"an array with unique items\"]);\n            }\n        }\n    },\n    additionalProperties: function (report, schema) {\n        // http://json-schema.org/latest/json-schema-validation.html#rfc.section.5.4.4.1\n        var type = Utils.whatIs(schema.additionalProperties);\n        if (type !== \"boolean\" && type !== \"object\") {\n            report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"additionalProperties\", [\"boolean\", \"object\"]]);\n        } else if (type === \"object\") {\n            report.path.push(\"additionalProperties\");\n            exports.validateSchema.call(this, report, schema.additionalProperties);\n            report.path.pop();\n        }\n    },\n    properties: function (report, schema) {\n        // http://json-schema.org/latest/json-schema-validation.html#rfc.section.5.4.4.1\n        if (Utils.whatIs(schema.properties) !== \"object\") {\n            report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"properties\", \"object\"]);\n            return;\n        }\n\n        var keys = Object.keys(schema.properties),\n            idx = keys.length;\n        while (idx--) {\n            var key = keys[idx],\n                val = schema.properties[key];\n            report.path.push(\"properties\");\n            report.path.push(key);\n            exports.validateSchema.call(this, report, val);\n            report.path.pop();\n            report.path.pop();\n        }\n\n        // custom - strict mode\n        if (this.options.forceAdditional === true && schema.additionalProperties === undefined) {\n            report.addError(\"KEYWORD_UNDEFINED_STRICT\", [\"additionalProperties\"]);\n        }\n        // custome - assume defined false mode\n        if (this.options.assumeAdditional && schema.additionalProperties === undefined) {\n            schema.additionalProperties = false;\n        }\n        // custom - forceProperties\n        if (this.options.forceProperties === true && keys.length === 0) {\n            report.addError(\"CUSTOM_MODE_FORCE_PROPERTIES\", [\"properties\"]);\n        }\n    },\n    patternProperties: function (report, schema) {\n        // http://json-schema.org/latest/json-schema-validation.html#rfc.section.5.4.4.1\n        if (Utils.whatIs(schema.patternProperties) !== \"object\") {\n            report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"patternProperties\", \"object\"]);\n            return;\n        }\n\n        var keys = Object.keys(schema.patternProperties),\n            idx = keys.length;\n        while (idx--) {\n            var key = keys[idx],\n                val = schema.patternProperties[key];\n            try {\n                RegExp(key);\n            } catch (e) {\n                report.addError(\"KEYWORD_PATTERN\", [\"patternProperties\", key]);\n            }\n            report.path.push(\"patternProperties\");\n            report.path.push(key.toString());\n            exports.validateSchema.call(this, report, val);\n            report.path.pop();\n            report.path.pop();\n        }\n\n        // custom - forceProperties\n        if (this.options.forceProperties === true && keys.length === 0) {\n            report.addError(\"CUSTOM_MODE_FORCE_PROPERTIES\", [\"patternProperties\"]);\n        }\n    },\n    dependencies: function (report, schema) {\n        // http://json-schema.org/latest/json-schema-validation.html#rfc.section.5.4.5.1\n        if (Utils.whatIs(schema.dependencies) !== \"object\") {\n            report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"dependencies\", \"object\"]);\n        } else {\n            var keys = Object.keys(schema.dependencies),\n                idx = keys.length;\n            while (idx--) {\n                var schemaKey = keys[idx],\n                    schemaDependency = schema.dependencies[schemaKey],\n                    type = Utils.whatIs(schemaDependency);\n\n                if (type === \"object\") {\n                    report.path.push(\"dependencies\");\n                    report.path.push(schemaKey);\n                    exports.validateSchema.call(this, report, schemaDependency);\n                    report.path.pop();\n                    report.path.pop();\n                } else if (type === \"array\") {\n                    var idx2 = schemaDependency.length;\n                    if (idx2 === 0) {\n                        report.addError(\"KEYWORD_MUST_BE\", [\"dependencies\", \"not empty array\"]);\n                    }\n                    while (idx2--) {\n                        if (typeof schemaDependency[idx2] !== \"string\") {\n                            report.addError(\"KEYWORD_VALUE_TYPE\", [\"dependensices\", \"string\"]);\n                        }\n                    }\n                    if (Utils.isUniqueArray(schemaDependency) === false) {\n                        report.addError(\"KEYWORD_MUST_BE\", [\"dependencies\", \"an array with unique items\"]);\n                    }\n                } else {\n                    report.addError(\"KEYWORD_VALUE_TYPE\", [\"dependencies\", \"object or array\"]);\n                }\n            }\n        }\n    },\n    enum: function (report, schema) {\n        // http://json-schema.org/latest/json-schema-validation.html#rfc.section.5.5.1.1\n        if (Array.isArray(schema.enum) === false) {\n            report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"enum\", \"array\"]);\n        } else if (schema.enum.length === 0) {\n            report.addError(\"KEYWORD_MUST_BE\", [\"enum\", \"an array with at least one element\"]);\n        } else if (Utils.isUniqueArray(schema.enum) === false) {\n            report.addError(\"KEYWORD_MUST_BE\", [\"enum\", \"an array with unique elements\"]);\n        }\n    },\n    type: function (report, schema) {\n        // http://json-schema.org/latest/json-schema-validation.html#rfc.section.5.5.2.1\n        var primitiveTypes = [\"array\", \"boolean\", \"integer\", \"number\", \"null\", \"object\", \"string\"],\n            primitiveTypeStr = primitiveTypes.join(\",\"),\n            isArray = Array.isArray(schema.type);\n\n        if (isArray) {\n            var idx = schema.type.length;\n            while (idx--) {\n                if (primitiveTypes.indexOf(schema.type[idx]) === -1) {\n                    report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"type\", primitiveTypeStr]);\n                }\n            }\n            if (Utils.isUniqueArray(schema.type) === false) {\n                report.addError(\"KEYWORD_MUST_BE\", [\"type\", \"an object with unique properties\"]);\n            }\n        } else if (typeof schema.type === \"string\") {\n            if (primitiveTypes.indexOf(schema.type) === -1) {\n                report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"type\", primitiveTypeStr]);\n            }\n        } else {\n            report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"type\", [\"string\", \"array\"]]);\n        }\n\n        if (this.options.noEmptyStrings === true) {\n            if (schema.type === \"string\" || isArray && schema.type.indexOf(\"string\") !== -1) {\n                if (schema.minLength === undefined &&\n                    schema.enum === undefined &&\n                    schema.format === undefined) {\n\n                    schema.minLength = 1;\n                }\n            }\n        }\n        if (this.options.noEmptyArrays === true) {\n            if (schema.type === \"array\" || isArray && schema.type.indexOf(\"array\") !== -1) {\n                if (schema.minItems === undefined) {\n                    schema.minItems = 1;\n                }\n            }\n        }\n        if (this.options.forceProperties === true) {\n            if (schema.type === \"object\" || isArray && schema.type.indexOf(\"object\") !== -1) {\n                if (schema.properties === undefined && schema.patternProperties === undefined) {\n                    report.addError(\"KEYWORD_UNDEFINED_STRICT\", [\"properties\"]);\n                }\n            }\n        }\n        if (this.options.forceItems === true) {\n            if (schema.type === \"array\" || isArray && schema.type.indexOf(\"array\") !== -1) {\n                if (schema.items === undefined) {\n                    report.addError(\"KEYWORD_UNDEFINED_STRICT\", [\"items\"]);\n                }\n            }\n        }\n        if (this.options.forceMinItems === true) {\n            if (schema.type === \"array\" || isArray && schema.type.indexOf(\"array\") !== -1) {\n                if (schema.minItems === undefined) {\n                    report.addError(\"KEYWORD_UNDEFINED_STRICT\", [\"minItems\"]);\n                }\n            }\n        }\n        if (this.options.forceMaxItems === true) {\n            if (schema.type === \"array\" || isArray && schema.type.indexOf(\"array\") !== -1) {\n                if (schema.maxItems === undefined) {\n                    report.addError(\"KEYWORD_UNDEFINED_STRICT\", [\"maxItems\"]);\n                }\n            }\n        }\n        if (this.options.forceMinLength === true) {\n            if (schema.type === \"string\" || isArray && schema.type.indexOf(\"string\") !== -1) {\n                if (schema.minLength === undefined &&\n                    schema.format === undefined &&\n                    schema.enum === undefined &&\n                    schema.pattern === undefined) {\n                    report.addError(\"KEYWORD_UNDEFINED_STRICT\", [\"minLength\"]);\n                }\n            }\n        }\n        if (this.options.forceMaxLength === true) {\n            if (schema.type === \"string\" || isArray && schema.type.indexOf(\"string\") !== -1) {\n                if (schema.maxLength === undefined &&\n                    schema.format === undefined &&\n                    schema.enum === undefined &&\n                    schema.pattern === undefined) {\n                    report.addError(\"KEYWORD_UNDEFINED_STRICT\", [\"maxLength\"]);\n                }\n            }\n        }\n    },\n    allOf: function (report, schema) {\n        // http://json-schema.org/latest/json-schema-validation.html#rfc.section.5.5.3.1\n        if (Array.isArray(schema.allOf) === false) {\n            report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"allOf\", \"array\"]);\n        } else if (schema.allOf.length === 0) {\n            report.addError(\"KEYWORD_MUST_BE\", [\"allOf\", \"an array with at least one element\"]);\n        } else {\n            var idx = schema.allOf.length;\n            while (idx--) {\n                report.path.push(\"allOf\");\n                report.path.push(idx.toString());\n                exports.validateSchema.call(this, report, schema.allOf[idx]);\n                report.path.pop();\n                report.path.pop();\n            }\n        }\n    },\n    anyOf: function (report, schema) {\n        // http://json-schema.org/latest/json-schema-validation.html#rfc.section.5.5.4.1\n        if (Array.isArray(schema.anyOf) === false) {\n            report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"anyOf\", \"array\"]);\n        } else if (schema.anyOf.length === 0) {\n            report.addError(\"KEYWORD_MUST_BE\", [\"anyOf\", \"an array with at least one element\"]);\n        } else {\n            var idx = schema.anyOf.length;\n            while (idx--) {\n                report.path.push(\"anyOf\");\n                report.path.push(idx.toString());\n                exports.validateSchema.call(this, report, schema.anyOf[idx]);\n                report.path.pop();\n                report.path.pop();\n            }\n        }\n    },\n    oneOf: function (report, schema) {\n        // http://json-schema.org/latest/json-schema-validation.html#rfc.section.5.5.5.1\n        if (Array.isArray(schema.oneOf) === false) {\n            report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"oneOf\", \"array\"]);\n        } else if (schema.oneOf.length === 0) {\n            report.addError(\"KEYWORD_MUST_BE\", [\"oneOf\", \"an array with at least one element\"]);\n        } else {\n            var idx = schema.oneOf.length;\n            while (idx--) {\n                report.path.push(\"oneOf\");\n                report.path.push(idx.toString());\n                exports.validateSchema.call(this, report, schema.oneOf[idx]);\n                report.path.pop();\n                report.path.pop();\n            }\n        }\n    },\n    not: function (report, schema) {\n        // http://json-schema.org/latest/json-schema-validation.html#rfc.section.5.5.6.1\n        if (Utils.whatIs(schema.not) !== \"object\") {\n            report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"not\", \"object\"]);\n        } else {\n            report.path.push(\"not\");\n            exports.validateSchema.call(this, report, schema.not);\n            report.path.pop();\n        }\n    },\n    definitions: function (report, schema) {\n        // http://json-schema.org/latest/json-schema-validation.html#rfc.section.5.5.7.1\n        if (Utils.whatIs(schema.definitions) !== \"object\") {\n            report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"definitions\", \"object\"]);\n        } else {\n            var keys = Object.keys(schema.definitions),\n                idx = keys.length;\n            while (idx--) {\n                var key = keys[idx],\n                    val = schema.definitions[key];\n                report.path.push(\"definitions\");\n                report.path.push(key);\n                exports.validateSchema.call(this, report, val);\n                report.path.pop();\n                report.path.pop();\n            }\n        }\n    },\n    format: function (report, schema) {\n        if (typeof schema.format !== \"string\") {\n            report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"format\", \"string\"]);\n        } else {\n            if (FormatValidators[schema.format] === undefined && this.options.ignoreUnknownFormats !== true) {\n                report.addError(\"UNKNOWN_FORMAT\", [schema.format]);\n            }\n        }\n    },\n    id: function (report, schema) {\n        // http://json-schema.org/latest/json-schema-core.html#rfc.section.7.2\n        if (typeof schema.id !== \"string\") {\n            report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"id\", \"string\"]);\n        }\n    },\n    title: function (report, schema) {\n        // http://json-schema.org/latest/json-schema-validation.html#rfc.section.6.1\n        if (typeof schema.title !== \"string\") {\n            report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"title\", \"string\"]);\n        }\n    },\n    description: function (report, schema) {\n        // http://json-schema.org/latest/json-schema-validation.html#rfc.section.6.1\n        if (typeof schema.description !== \"string\") {\n            report.addError(\"KEYWORD_TYPE_EXPECTED\", [\"description\", \"string\"]);\n        }\n    },\n    \"default\": function (/* report, schema */) {\n        // http://json-schema.org/latest/json-schema-validation.html#rfc.section.6.2\n        // There are no restrictions placed on the value of this keyword.\n    }\n};\n\n/**\n *\n * @param {Report} report\n * @param {*[]} arr\n *\n * @returns {boolean}\n */\nvar validateArrayOfSchemas = function (report, arr) {\n    var idx = arr.length;\n    while (idx--) {\n        exports.validateSchema.call(this, report, arr[idx]);\n    }\n    return report.isValid();\n};\n\n/**\n *\n * @param {Report} report\n * @param {*} schema\n */\nexports.validateSchema = function (report, schema) {\n\n    report.commonErrorMessage = \"SCHEMA_VALIDATION_FAILED\";\n\n    // if schema is an array, assume it's an array of schemas\n    if (Array.isArray(schema)) {\n        return validateArrayOfSchemas.call(this, report, schema);\n    }\n\n    // do not revalidate schema that has already been validated once\n    if (schema.__$validated) {\n        return true;\n    }\n\n    // if $schema is present, this schema should validate against that $schema\n    var hasParentSchema = schema.$schema && schema.id !== schema.$schema;\n    if (hasParentSchema) {\n        if (schema.__$schemaResolved && schema.__$schemaResolved !== schema) {\n            var subReport = new Report(report);\n            var valid = JsonValidation.validate.call(this, subReport, schema.__$schemaResolved, schema);\n            if (valid === false) {\n                report.addError(\"PARENT_SCHEMA_VALIDATION_FAILED\", null, subReport);\n            }\n        } else {\n            if (this.options.ignoreUnresolvableReferences !== true) {\n                report.addError(\"REF_UNRESOLVED\", [schema.$schema]);\n            }\n        }\n    }\n\n    if (this.options.noTypeless === true) {\n        // issue #36 - inherit type to anyOf, oneOf, allOf if noTypeless is defined\n        if (schema.type !== undefined) {\n            var schemas = [];\n            if (Array.isArray(schema.anyOf)) { schemas = schemas.concat(schema.anyOf); }\n            if (Array.isArray(schema.oneOf)) { schemas = schemas.concat(schema.oneOf); }\n            if (Array.isArray(schema.allOf)) { schemas = schemas.concat(schema.allOf); }\n            schemas.forEach(function (sch) {\n                if (!sch.type) { sch.type = schema.type; }\n            });\n        }\n        // end issue #36\n        if (schema.enum === undefined &&\n            schema.type === undefined &&\n            schema.anyOf === undefined &&\n            schema.oneOf === undefined &&\n            schema.not === undefined &&\n            schema.$ref === undefined) {\n            report.addError(\"KEYWORD_UNDEFINED_STRICT\", [\"type\"]);\n        }\n    }\n\n    var keys = Object.keys(schema),\n        idx = keys.length;\n    while (idx--) {\n        var key = keys[idx];\n        if (key.indexOf(\"__\") === 0) { continue; }\n        if (SchemaValidators[key] !== undefined) {\n            SchemaValidators[key].call(this, report, schema);\n        } else if (!hasParentSchema) {\n            if (this.options.noExtraKeywords === true) {\n                report.addError(\"KEYWORD_UNEXPECTED\", [key]);\n            }\n        }\n    }\n\n    if (this.options.pedanticCheck === true) {\n        if (schema.enum) {\n            // break recursion\n            var tmpSchema = Utils.clone(schema);\n            delete tmpSchema.enum;\n            delete tmpSchema.default;\n\n            report.path.push(\"enum\");\n            idx = schema.enum.length;\n            while (idx--) {\n                report.path.push(idx.toString());\n                JsonValidation.validate.call(this, report, tmpSchema, schema.enum[idx]);\n                report.path.pop();\n            }\n            report.path.pop();\n        }\n\n        if (schema.default) {\n            report.path.push(\"default\");\n            JsonValidation.validate.call(this, report, schema, schema.default);\n            report.path.pop();\n        }\n    }\n\n    var isValid = report.isValid();\n    if (isValid) {\n        schema.__$validated = true;\n    }\n    return isValid;\n};\n"]},"metadata":{},"sourceType":"script"}